<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Poison Browser</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  :root {
    --bg1: #1a0b00;
    --bg2: #0b0500;
    --bg3: #000000;
    --orange-main: #ff8a00;
    --orange-neon: #ffb347;
    --orange-deep: #ff5e00;
    --text-main: #fff7ec;
    --text-muted: #9a8c7a;
    --accent-soft: #ffcf70;
  }

  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  html, body {
    height: 100%;
    width: 100%;
    overflow: hidden;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
    background:
      radial-gradient(circle at top left, rgba(255, 138, 0, 0.28), transparent 55%),
      radial-gradient(circle at bottom right, rgba(255, 94, 0, 0.25), transparent 55%),
      linear-gradient(145deg, var(--bg1), var(--bg2), var(--bg3));
    color: var(--text-main);
  }

  body {
    display: flex;
    flex-direction: column;
  }

  .chrome {
    display: flex;
    flex-direction: column;
    height: 100%;
    padding: 10px 10px 8px;
    gap: 8px;
  }

  .topbar {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .address-wrapper {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 10px;
    background: rgba(0, 0, 0, 0.6);
    border-radius: 999px;
    box-shadow:
      0 0 0 1px rgba(255, 138, 0, 0.45),
      0 0 18px rgba(255, 138, 0, 0.35);
    backdrop-filter: blur(12px);
  }

  .addr-icon {
    color: var(--orange-main);
    font-size: 14px;
  }

  .address-input {
    flex: 1;
    border: none;
    background: transparent;
    color: var(--text-main);
    font-size: 14px;
    outline: none;
  }

  .address-input::placeholder {
    color: var(--text-muted);
  }

  .go-btn {
    border: none;
    background: linear-gradient(135deg, var(--orange-main), var(--orange-deep));
    color: #140800;
    font-size: 12px;
    font-weight: 600;
    padding: 6px 10px;
    border-radius: 999px;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    box-shadow:
      0 0 12px rgba(255, 138, 0, 0.5),
      0 0 0 1px rgba(0, 0, 0, 0.7);
  }

  .poison-toggle {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    border-radius: 999px;
    background: rgba(0, 0, 0, 0.75);
    border: 1px solid rgba(255, 138, 0, 0.6);
    box-shadow:
      0 0 12px rgba(255, 138, 0, 0.5),
      0 0 0 1px rgba(0, 0, 0, 0.7);
    cursor: pointer;
  }

  .poison-circle {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    background: #555555;
    box-shadow: 0 0 0 1px rgba(0,0,0,0.8);
    flex-shrink: 0;
  }

  .poison-circle.active {
    background: var(--orange-main);
    box-shadow:
      0 0 6px rgba(255, 138, 0, 1),
      0 0 16px rgba(255, 138, 0, 0.95);
    animation: poisonBlink 1.4s ease-in-out infinite;
  }

  .poison-text {
    font-size: 11px;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: var(--text-muted);
    text-shadow: none;
    white-space: nowrap;
  }

  .poison-text.active {
    color: var(--accent-soft);
    text-shadow:
      0 0 8px rgba(255, 138, 0, 0.9),
      0 0 18px rgba(255, 94, 0, 0.7);
  }

  .middle {
    flex: 1;
    position: relative;
    border-radius: 14px;
    overflow: hidden;
    box-shadow:
      0 0 0 1px rgba(255, 255, 255, 0.12),
      0 18px 40px rgba(0, 0, 0, 0.85);
    background: radial-gradient(circle at top, rgba(255, 138, 0, 0.12), #050200);
  }

  iframe {
    width: 100%;
    height: 100%;
    border: none;
    background: #050200;
  }

  .bottom {
    font-size: 11px;
    color: var(--text-muted);
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .status-line {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .status-dot {
    width: 7px;
    height: 7px;
    border-radius: 50%;
    background: var(--orange-main);
    box-shadow: 0 0 6px rgba(255, 138, 0, 0.8);
  }

  .status-strong {
    color: var(--text-main);
  }

  @keyframes poisonBlink {
    0%   { opacity: 0.4; transform: scale(0.9); }
    50%  { opacity: 1;   transform: scale(1.1); }
    100% { opacity: 0.4; transform: scale(0.9); }
  }
</style>
</head>
<body>
<div class="chrome">
  <div class="topbar">
    <div class="address-wrapper">
      <span class="addr-icon">â—Ž</span>
      <input id="addressInput" class="address-input"
             placeholder="Enter URL or search"
             autocomplete="off" spellcheck="false" />
      <button class="go-btn" id="goButton">GO</button>
    </div>

    <!-- Poison button top-right -->
    <button class="poison-toggle" id="poisonToggle" type="button">
      <span class="poison-circle" id="poisonCircle"></span>
      <span class="poison-text" id="poisonText">Poison</span>
    </button>
  </div>

  <div class="middle">
    <iframe id="view" src="https://wikipedia.org"></iframe>
  </div>

  <div class="bottom">
    <div class="status-line">
      <div class="status-dot"></div>
      <div class="status-strong" id="statusPrimary">
        Ephemeral session
      </div>
    </div>
    <div id="statusSecondary">
      No history. Poison only affects JS & scroll noise where allowed.
    </div>
  </div>
</div>

<script>
(function() {
  const iframe = document.getElementById('view');
  const addrInput = document.getElementById('addressInput');
  const goButton = document.getElementById('goButton');

  const poisonToggle = document.getElementById('poisonToggle');
  const poisonCircle = document.getElementById('poisonCircle');
  const poisonText = document.getElementById('poisonText');
  const statusPrimary = document.getElementById('statusPrimary');
  const statusSecondary = document.getElementById('statusSecondary');

  let poisonOn = false;
  let noiseInterval = null;

  const languagePool = ['en-US','en-GB','fr-FR','de-DE','es-ES','it-IT'];
  const tzPool = ['UTC','Europe/Paris','Europe/Berlin','America/New_York','Asia/Tokyo','Europe/London'];

  function randomChoice(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  }

  function normalizeURL(input) {
    input = input.trim();
    if (!input) return null;

    // If it already looks like URL with scheme.
    if (/^https?:\/\//i.test(input)) {
      return input;
    }

    // If it looks like a domain.
    if (input.includes('.') && !input.includes(' ')) {
      return 'https://' + input;
    }

    // Otherwise, treat as search query with DuckDuckGo (may or may not show in iframe).
    return 'https://duckduckgo.com/?q=' + encodeURIComponent(input);
  }

  function navigate() {
    const u = normalizeURL(addrInput.value);
    if (!u) return;
    iframe.src = u;
  }

  goButton.addEventListener('click', navigate);
  addrInput.addEventListener('keydown', e => {
    if (e.key === 'Enter') navigate();
  });

  // Poison toggle behavior
  function setPoisonState(on) {
    poisonOn = on;

    if (on) {
      poisonCircle.classList.add('active');
      poisonText.classList.add('active');
      poisonText.textContent = 'Poisoning';
      statusPrimary.textContent = 'Ephemeral + noisy session';
      statusSecondary.textContent = 'Some JS hints & scroll noise may be altered.';
      installNoise();
      injectPoisonIntoIframe();
    } else {
      poisonCircle.classList.remove('active');
      poisonText.classList.remove('active');
      poisonText.textContent = 'Poison';
      statusPrimary.textContent = 'Ephemeral session';
      statusSecondary.textContent = 'No history. Poison only when activated.';
      clearNoise();
    }
  }

  poisonToggle.addEventListener('click', () => setPoisonState(!poisonOn));

  // Lightweight noise: iframe-only scroll nudge
  function installNoise() {
    clearNoise();
    noiseInterval = setInterval(() => {
      if (!poisonOn) return;
      try {
        const win = iframe.contentWindow;
        const doc = iframe.contentDocument || (win && win.document);
        if (!win || !doc) return;

        const body = doc.scrollingElement || doc.body;
        if (!body) return;

        const maxScroll = body.scrollHeight - body.clientHeight;
        if (maxScroll <= 0) return;

        const delta = (Math.random() - 0.5) * 40;
        let target = win.scrollY + delta;
        if (target < 0) target = 0;
        if (target > maxScroll) target = maxScroll;
        win.scrollTo({ top: target, behavior: 'smooth' });
      } catch (e) {
        // cross-origin, ignore
      }
    }, 5000 + Math.random() * 5000);
  }

  function clearNoise() {
    if (noiseInterval) {
      clearInterval(noiseInterval);
      noiseInterval = null;
    }
  }

  // JS tweaks inside iframe when allowed (same-origin only)
  function injectPoisonIntoIframe() {
    const lang = randomChoice(languagePool);
    const tz = randomChoice(tzPool);

    try {
      const win = iframe.contentWindow;
      const doc = iframe.contentDocument || (win && win.document);
      if (!win || !doc) return;

      const script = doc.createElement('script');
      script.textContent = `
        try {
          Object.defineProperty(navigator, 'language', {
            get: function() { return '${lang}'; }
          });
        } catch (e) {}

        try {
          const origResolved = Intl.DateTimeFormat.prototype.resolvedOptions;
          Intl.DateTimeFormat.prototype.resolvedOptions = function() {
            const o = origResolved.apply(this, arguments);
            o.timeZone = '${tz}';
            return o;
          };
        } catch (e) {}
      `;
      (doc.head || doc.documentElement).appendChild(script);
    } catch (e) {
      // cross-origin, ignore
    }
  }

  iframe.addEventListener('load', () => {
    if (poisonOn) injectPoisonIntoIframe();
  });

  // Prefill
  addrInput.value = 'https://wikipedia.org';
})();
</script>
</body>
</html>
