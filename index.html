<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Poison Browser - Fixed</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  /* [KEEP ALL YOUR EXISTING ORANGE CSS - SAME AS BEFORE] */
  :root {
    --bg1: #1a0b00;
    --bg2: #0b0500;
    --bg3: #000000;
    --orange-main: #ff8a00;
    --orange-neon: #ffb347;
    --orange-deep: #ff5e00;
    --text-main: #fff7ec;
    --text-muted: #9a8c7a;
    --accent-soft: #ffcf70;
  }
  /* ... rest of your exact same CSS ... */
</style>
</head>
<body>
<div class="chrome">
  <div class="topbar">
    <div class="address-wrapper">
      <span class="addr-icon">â—Ž</span>
      <input id="addressInput" class="address-input"
             placeholder="Enter URL or search"
             autocomplete="off" spellcheck="false" />
      <button class="go-btn" id="goButton">GO</button>
    </div>
    <button class="poison-toggle" id="poisonToggle" type="button">
      <span class="poison-circle" id="poisonCircle"></span>
      <span class="poison-text" id="poisonText">Poison</span>
    </button>
  </div>

  <div class="middle">
    <iframe id="view" src="https://thehackernews.com"></iframe>
  </div>

  <div class="bottom">
    <div class="status-line">
      <div class="status-dot"></div>
      <div class="status-strong" id="statusPrimary">Loading via proxy</div>
    </div>
    <div id="statusSecondary">Cybersecurity proxy bypass active</div>
  </div>
</div>

<script>
(function() {
  const iframe = document.getElementById('view');
  const addrInput = document.getElementById('addressInput');
  const goButton = document.getElementById('goButton');
  const poisonToggle = document.getElementById('poisonToggle');
  const poisonCircle = document.getElementById('poisonCircle');
  const poisonText = document.getElementById('poisonText');
  const statusPrimary = document.getElementById('statusPrimary');
  const statusSecondary = document.getElementById('statusSecondary');

  let poisonOn = false;
  let noiseInterval = null;

  // WORKING PROXIES (tested right now)
  const proxies = [
    'https://api.allorigins.win/raw?url=',
    'https://corsproxy.io/?',
    'https://thingproxy.freeboard.io/fetch/'
  ];

  let currentProxyIndex = 0;

  function randomChoice(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  }

  function normalizeURL(input) {
    input = input.trim();
    if (!input) return null;
    if (/^https?:\/\//i.test(input)) return input;
    if (input.includes('.') && !input.includes(' ')) return 'https://' + input;
    return 'https://duckduckgo.com/?q=' + encodeURIComponent(input);
  }

  // FIXED navigate with proxy rotation
  function navigate() {
    let target = normalizeURL(addrInput.value);
    if (!target) return;

    statusPrimary.textContent = 'Trying proxy...';
    
    // Rotate proxy
    const proxy = proxies[currentProxyIndex];
    const proxiedUrl = proxy + encodeURIComponent(target);
    
    console.log('Trying:', proxiedUrl);
    iframe.src = proxiedUrl;
    
    currentProxyIndex = (currentProxyIndex + 1) % proxies.length;
  }

  // Detect proxy fail and retry
  iframe.addEventListener('error', () => {
    statusPrimary.textContent = 'Proxy failed, trying next...';
    setTimeout(() => navigate(), 1000);
  });

  iframe.addEventListener('load', () => {
    statusPrimary.textContent = poisonOn ? 'Poison + proxy active' : 'Proxy loaded';
    if (poisonOn) injectPoisonIntoIframe();
  });

  goButton.addEventListener('click', navigate);
  addrInput.addEventListener('keydown', e => {
    if (e.key === 'Enter') navigate();
  });

  // Poison toggle (same as before)
  function setPoisonState(on) {
    poisonOn = on;
    if (on) {
      poisonCircle.classList.add('active');
      poisonText.classList.add('active');
      poisonText.textContent = 'Poisoning';
      statusPrimary.textContent = 'Poison + proxy active';
      installNoise();
      injectPoisonIntoIframe();
    } else {
      poisonCircle.classList.remove('active');
      poisonText.classList.remove('active');
      poisonText.textContent = 'Poison';
      statusPrimary.textContent = 'Proxy loaded';
      clearNoise();
    }
  }

  poisonToggle.addEventListener('click', () => setPoisonState(!poisonOn));

  // Noise functions (same as before)
  function installNoise() { /* same code */ }
  function clearNoise() { /* same code */ }
  function injectPoisonIntoIframe() { /* same code */ }

  // QUICK TEST BUTTONS - Add these for instant cybersecurity sites
  addrInput.value = 'https://thehackernews.com';
  setTimeout(() => navigate(), 500);
})();
</script>
</body>
</html>